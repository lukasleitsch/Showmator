var Options=function(){var t={},e="http://localhost:63123",o=io.connect(e),l,n="",a,i,c,r,u,s,g,p,f,h,m,v=function(){i=$("body"),c=$("#slug"),r=$("#submit-slug"),u=$("#slug-static"),s=$("#shortcut"),g=$("#text-only"),p=$("#blacklist"),f=$("#title-shownotes"),h=$("#title-shownotes-alert"),m=$("#create-new"),a=h.data("no-title")},d=function(){return Math.random().toString(36).substring(7)},S=function(t){return $("<div/>").html(t).text()},w=function(t){var o;t.active?(k(!0),f.val(S(t.title)),h.text(S(t.title)||a),o=localStorage.slug,l=t.publicSlug,localStorage.publicSlug=l):(k(!1),o=d(),l=d(),h.text(a),f.val("")),c.val(o),u.text(o),n=f.val(),$("#html").prop("href",e+"/html/"+o),$("#live").prop("href",e+"/live/"+l)},k=function(t){var e="has-active-shownotes",o="has-no-active-shownotes";i.toggleClass(e,t).toggleClass(o,!t)},b=function(){chrome.commands.getAll(function(t){var e=!1;$.each(t,function(t,o){"_execute_browser_action"==o.name&&""!==o.shortcut&&(e=!0,s.text(o.shortcut.replace(/\+/g," + ")))}),e||s.html("<em>"+s.data("no-shortcut")+"</em>")})},y=function(t){t.preventDefault(),chrome.tabs.create({url:"chrome://extensions/configureCommands"})},x=function(t){t.preventDefault(),i.animate({scrollTop:i.outerHeight()})},T=function(t,e,o,l){o=o||1e3;var n=3e3,a=(new Date).getTime(),i=function(){return t.data("created-ts")==a};t.tooltip("destroy").data("created-ts",a),window.setTimeout(function(){i()&&("function"==typeof e&&e(),t.tooltip({title:"âœ” Gespeichert",placement:l||"right",trigger:"manual",container:"body"}).tooltip("show"),window.setTimeout(function(){i()&&t.tooltip("destroy")},n))},o)},O=function(t,e){c.tooltip({title:t,placement:"bottom",trigger:"manual",html:!!e}).tooltip("show").one("keyup",function(){c.tooltip("destroy")})},C=function(){var e=$.trim(c.val()).replace(/ /g,"");e?/^[a-zA-Z0-9]+$/g.test(e)?(o.emit("createNewShownotes",{slug:e,publicSlug:l}),localStorage.slug=e,u.text(e),localStorage.publicSlug=l,k(!0),t.init()):O(c.data("invalid"),!0):O(c.data("empty"))},D=function(t){13==t.keyCode&&r.click()},I=function(){var t=$(this).val();t!=n&&(n=t,h.text(t||a),T(f,_))},_=function(){o.emit("updateShownotesTitle",{slug:localStorage.slug,title:f.val()})},A=function(){var t=$(this).is(":checked");t?localStorage.showTextOnly=!0:localStorage.removeItem("showTextOnly"),T(g,!1,200,"top")},q=function(){p.val()!=localStorage.blacklist&&(localStorage.blacklist=p.val(),T(p))},z=function(e){e.preventDefault(),window.confirm(m.data("confirm"))&&(localStorage.removeItem("slug"),localStorage.removeItem("publicSlug"),k(!1),t.init())},G=function(){r.click(C),c.keyup(D),f.keyup(I),$("#link-to-shortcut-options").click(y),$(window).focus(b),g.change(A),p.keyup(q),m.click(z),$("#alert-link-create-new").click(x)};return t.init=function(){v(),o.emit("requestStatus",{slug:localStorage.slug}),o.on("respondToStatus",w),b(),g.prop("checked",!!localStorage.showTextOnly),"undefined"!=typeof localStorage.blacklist&&p.val(localStorage.blacklist),G()},t}();$(function(){Options.init()});