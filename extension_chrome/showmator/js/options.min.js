$(function(){var t="http://localhost:63123",e=io.connect(t),o="has-active-shownotes",l="has-no-active-shownotes",a=$("body"),n=$("#slug"),c=$("#submit-slug"),i=$("#slug-static"),r=$("#shortcut"),u=$("#text-only"),s=$("#blacklist"),g=$("#title-shownotes"),h=$("#title-shownotes-alert"),m=$("#create-new"),p=h.data("no-title"),f,v=function(){e.emit("requestStatus",{slug:localStorage.slug}),e.on("respondToStatus",function(e){var o;e.active?(d(!0),g.val(b(e.title)),h.text(b(e.title)||p),o=localStorage.slug,f=e.publicSlug,localStorage.publicSlug=f):(d(!1),o=w(),f=w(),h.text(p),g.val("")),n.val(o),i.text(o),x=g.val(),$("#html").prop("href",t+"/html/"+o),$("#live").prop("href",t+"/live/"+f)}),S(),u.prop("checked",!!localStorage.showTextOnly),"undefined"!=typeof localStorage.blacklist&&s.val(localStorage.blacklist)},d=function(t){a.toggleClass(o,t).toggleClass(l,!t)},S=function(){chrome.commands.getAll(function(t){var e=!1;$.each(t,function(t,o){"_execute_browser_action"==o.name&&""!==o.shortcut&&(e=!0,r.text(o.shortcut.replace(/\+/g," + ")))}),e||r.html("<em>"+r.data("no-shortcut")+"</em>")})},w=function(){return Math.random().toString(36).substring(7)},k=function(){e.emit("updateShownotesTitle",{slug:localStorage.slug,title:g.val()})},y=function(t,e,o,l){o=o||1e3;var a=3e3,n=(new Date).getTime(),c=function(){return t.data("created-ts")==n};t.tooltip("destroy").data("created-ts",n),window.setTimeout(function(){c()&&("function"==typeof e&&e(),t.tooltip({title:"âœ” Gespeichert",placement:l||"right",trigger:"manual",container:"body"}).tooltip("show"),window.setTimeout(function(){c()&&t.tooltip("destroy")},a))},o)},b=function(t){return $("<div/>").html(t).text()};c.click(function(){var t=$.trim(n.val()).replace(/ /g,""),o=function(t,e){n.tooltip({title:t,placement:"bottom",trigger:"manual",html:!!e}).tooltip("show").one("keyup",function(){n.tooltip("destroy")})};t?/^[a-zA-Z0-9]+$/g.test(t)?(e.emit("createNewShownotes",{slug:t,publicSlug:f}),localStorage.slug=t,i.text(t),localStorage.publicSlug=f,d(!0),v()):o(n.data("invalid"),!0):o(n.data("empty"))}),n.keyup(function(t){13==t.keyCode&&c.click()});var x="";g.keyup(function(){var t=$(this).val();t!=x&&(x=t,h.text(t||p),y(g,k))}),$("#link-to-shortcut-options").click(function(t){t.preventDefault(),chrome.tabs.create({url:"chrome://extensions/configureCommands"})}),$(window).focus(S),u.change(function(){var t=$(this).is(":checked");t?localStorage.showTextOnly=!0:localStorage.removeItem("showTextOnly"),y(u,!1,200,"top")}),s.keyup(function(){s.val()!=localStorage.blacklist&&(localStorage.blacklist=s.val(),y(s))}),m.click(function(t){t.preventDefault(),window.confirm(m.data("confirm"))&&(localStorage.removeItem("slug"),localStorage.removeItem("publicSlug"),d(!1),v())}),$("#alert-link-create-new").click(function(t){t.preventDefault(),a.animate({scrollTop:a.outerHeight()})}),v(),localStorage.removeItem("showTextonly")});